class Calendar{constructor(t,e=null,n=[],a=[]){this.containerID=t,this.today=null==e?new Date:e,this.events=n,this.days=0==a.length?["Po","Út","St","Čt","Pá","So","Ne"]:a;for(let t=0;t<this.events.length;t++)this.events[t].date=this.normalizeDate(this.events[t].date)}normalizeDate(t){return t.toISOString().slice(0,10)}addEvent(t,e,n=!1){if(e=this.normalizeDate(e),this.events.push({name:t,date:e}),n){const t=document.getElementById("date-picker").value;this.redrawCalendar(),document.getElementById("date-picker").value=t}}createNavigationBar(){const t=document.createElement("div");t.classList.add("navigation-bar");const e=document.createElement("button");e.id="btn-prev",e.innerHTML="&larr;";const n=document.createElement("input");n.id="date-picker",n.type="date";const a=document.createElement("button");return a.id="btn-next",a.innerHTML="&rarr;",t.appendChild(e),t.appendChild(n),t.appendChild(a),t}render(){this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0]}redrawCalendar(){const t=document.getElementById(this.containerID);if(!t)throw ReferenceError(`Element with ID: ${this.containerID} not found`);t.innerHTML="",t.appendChild(this.createNavigationBar());const e=this.getDaysInMonth(this.today.getFullYear(),this.today.getMonth()),n=new Date(e[0]);let a=document.createElement("div");a.classList.add("calendar-container");let d=null;for(let t=0;t<this.days.length;t++)d=document.createElement("div"),d.classList.add("calendar-cell"),d.classList.add("header"),d.innerText=this.days[t],a.appendChild(d);let i=this.getDaysInPrevMonth(this.today);for(let t=i.length-(0==n.getDay()?6:n.getDay()-1);t<i.length;t++)d=document.createElement("div"),d.classList.add("calendar-cell-other-month"),d.innerText=new Date(i[t]).getDate(),a.appendChild(d);for(let t=0;t<e.length;t++){d=document.createElement("div"),d.classList.add("calendar-cell"),this.today.getDate()-1==t&&d.classList.add("cell-today");const n=this.events.filter(n=>this.normalizeDate(new Date(e[t]))==n.date);if(n.length>0){const e=document.createElement("div");e.classList.add("event"),e.innerText=t+1,e.title=this.getTitle(n),d.appendChild(e)}else d.innerText=t+1;a.appendChild(d)}const l=49-a.childElementCount;for(let t=0;t<l;t++)d=document.createElement("div"),d.classList.add("calendar-cell-other-month"),d.innerText=t+1,a.appendChild(d);t.appendChild(a),this.appendCalendarEvents()}getTitle(t){return t.map(t=>t.name).join(",")}appendCalendarEvents(){const t=document.getElementById("btn-next");t.addEventListener("click",()=>{const t=this.today.getMonth(),e=this.today.getFullYear();11==t?(this.today.setMonth(0),this.today.setFullYear(e+1)):this.today.setMonth(t+1),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0]});const e=document.getElementById("btn-prev");e.addEventListener("click",()=>{const t=this.today.getMonth(),e=this.today.getFullYear();0==t?(this.today.setMonth(11),this.today.setFullYear(e-1)):this.today.setMonth(t-1),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0]});const n=document.getElementById("date-picker");n.addEventListener("blur",t=>{this.today=new Date(document.getElementById("date-picker").value),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0]})}getDaysInPrevMonth(t){let e=t.getFullYear(),n=t.getMonth();return 0==n&&(n=11,e-=1),this.getDaysInMonth(e,n)}getDaysInNextMonth(t){let e=t.getFullYear(),n=t.getMonth();return 11==n&&(n=0,e+=1),this.getDaysInMonth(lastYear,lastMonth)}getDaysInMonth(t,e){const n=[],a=new Date(t,e,1);for(;a.getMonth()===e;)n.push(new Date(a)),a.setDate(a.getDate()+1);return n}}