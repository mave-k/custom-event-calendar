class Calendar{constructor(t,e=null,a=[],n=[]){this.containerID=t,this.today=null==e?new Date:e,this.events=a,this.days=0==n.length?["Po","Út","St","Čt","Pá","So","Ne"]:n;for(let t=0;t<this.events.length;t++)this.events[t].date=this.normalizeDate(this.events[t].date);this.displayedDates=[],this.eventCallback=null}normalizeDate(t){return t.toISOString().slice(0,10)}addEvent(t,e,a=!1){if(e=this.normalizeDate(e),this.events.push({name:t,date:e}),a){const t=document.getElementById("date-picker").value;this.redrawCalendar(),document.getElementById("date-picker").value=t}}createNavigationBar(){const t=document.createElement("div");t.classList.add("navigation-bar");const e=document.createElement("button");e.id="btn-prev",e.innerHTML="&larr;";const a=document.createElement("input");a.id="date-picker",a.type="date";const n=document.createElement("button");return n.id="btn-next",n.innerHTML="&rarr;",t.appendChild(e),t.appendChild(a),t.appendChild(n),t}render(){this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0]}redrawCalendar(){const t=document.getElementById(this.containerID);if(!t)throw ReferenceError(`Element with ID: ${this.containerID} not found`);this.displayedDates=[],t.innerHTML="",t.appendChild(this.createNavigationBar());const e=this.getDaysInMonth(this.today.getFullYear(),this.today.getMonth()),a=new Date(e[0]);let n=document.createElement("div");n.classList.add("calendar-container");let d=null;for(let t=0;t<this.days.length;t++)d=document.createElement("div"),d.classList.add("calendar-cell"),d.classList.add("header"),d.innerText=this.days[t],n.appendChild(d);let s=this.getDaysInPrevMonth(this.today),l=null;for(let t=s.length-(0==a.getDay()?6:a.getDay()-1);t<s.length;t++)d=document.createElement("div"),d.classList.add("calendar-cell-other-month"),l=new Date(s[t]),d.innerText=l.getDate(),this.displayedDates.push(l),n.appendChild(d);for(let t=0;t<e.length;t++){d=document.createElement("div"),d.classList.add("calendar-cell"),this.today.getDate()-1==t&&d.classList.add("cell-today");const a=this.events.filter(a=>this.normalizeDate(new Date(e[t]))==a.date);if(a.length>0){const t=document.createElement("div");t.classList.add("event"),l=new Date(a[0].date),console.log(a[0].date),t.innerText=l.getDate(),this.displayedDates.push(l),t.title=this.getTitle(a),d.appendChild(t)}else l=new Date(e[t]),d.innerText=l.getDate(),this.displayedDates.push(l);n.appendChild(d)}let i=this.getDaysInNextMonth(this.today);const r=49-n.childElementCount;for(let t=0;t<r;t++)d=document.createElement("div"),d.classList.add("calendar-cell-other-month"),l=new Date(i[t]),d.innerText=l.getDate(),this.displayedDates.push(l),n.appendChild(d);t.appendChild(n),this.appendCalendarEvents()}getTitle(t){return t.map(t=>t.name).join(",")}appendCalendarEvents(){const t=document.getElementById("btn-next");t.addEventListener("click",()=>{const t=this.today.getMonth(),e=this.today.getFullYear();11==t?(this.today.setMonth(0),this.today.setFullYear(e+1)):this.today.setMonth(t+1),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0],this.executeCallback()});const e=document.getElementById("btn-prev");e.addEventListener("click",()=>{const t=this.today.getMonth(),e=this.today.getFullYear();0==t?(this.today.setMonth(11),this.today.setFullYear(e-1)):this.today.setMonth(t-1),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0],this.executeCallback()});const a=document.getElementById("date-picker");a.addEventListener("blur",t=>{this.today=new Date(document.getElementById("date-picker").value),this.redrawCalendar(),document.getElementById("date-picker").value=this.today.toISOString().split("T")[0],this.executeCallback()})}setEventCallback(t){this.eventCallback=t}executeCallback(){this.eventCallback&&this.eventCallback(this.displayedDates)}getDaysInPrevMonth(t){let e=t.getFullYear(),a=t.getMonth();return 0==a?(a=11,e-=1):a-=1,this.getDaysInMonth(e,a)}getDaysInNextMonth(t){let e=t.getFullYear(),a=t.getMonth();return 11==a?(a=0,e+=1):a+=1,this.getDaysInMonth(e,a)}getDaysInMonth(t,e){const a=[],n=new Date(t,e,1);for(;n.getMonth()===e;)a.push(new Date(this.normalizeDate(n))),n.setDate(n.getDate()+1);return a}}